{
  "cells": [
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "view-in-github",
        "colab_type": "text"
      },
      "source": [
        "<a href=\"https://colab.research.google.com/github/edtechrepo/entrada-queries/blob/main/Colab%20Faculty%20Entrada%20Queries%20\" target=\"_parent\"><img src=\"https://colab.research.google.com/assets/colab-badge.svg\" alt=\"Open In Colab\"/></a>"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "fSH_5HKRbxpv"
      },
      "source": [
        "NOTE: the csv is deleted as soon as the notebook runtime is terminated. A copy of the csv can be found on the github page"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "I4syb80OWaXS"
      },
      "source": [
        "- [ ] Duplicate Data\n",
        "- [ ] Make all queries lowercase"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "QexDhHJ2Apvd"
      },
      "source": [
        "# Cleaning Data"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "background_save": true,
          "base_uri": "https://localhost:8080/"
        },
        "id": "key7VdZRbJo6",
        "outputId": "480c815f-82b3-4175-bbe6-7def4eda1e11"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Collecting fuzzywuzzy\n",
            "  Downloading fuzzywuzzy-0.18.0-py2.py3-none-any.whl.metadata (4.9 kB)\n",
            "Collecting python-Levenshtein\n",
            "  Downloading python_Levenshtein-0.26.1-py3-none-any.whl.metadata (3.7 kB)\n",
            "Collecting Levenshtein==0.26.1 (from python-Levenshtein)\n",
            "  Downloading levenshtein-0.26.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (3.2 kB)\n",
            "Collecting rapidfuzz<4.0.0,>=3.9.0 (from Levenshtein==0.26.1->python-Levenshtein)\n",
            "  Downloading rapidfuzz-3.10.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (11 kB)\n",
            "Downloading fuzzywuzzy-0.18.0-py2.py3-none-any.whl (18 kB)\n",
            "Downloading python_Levenshtein-0.26.1-py3-none-any.whl (9.4 kB)\n",
            "Downloading levenshtein-0.26.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (162 kB)\n",
            "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m162.6/162.6 kB\u001b[0m \u001b[31m6.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hDownloading rapidfuzz-3.10.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (3.1 MB)\n",
            "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m3.1/3.1 MB\u001b[0m \u001b[31m15.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hInstalling collected packages: fuzzywuzzy, rapidfuzz, Levenshtein, python-Levenshtein\n",
            "Successfully installed Levenshtein-0.26.1 fuzzywuzzy-0.18.0 python-Levenshtein-0.26.1 rapidfuzz-3.10.1\n"
          ]
        }
      ],
      "source": [
        "#imports\n",
        "!pip install fuzzywuzzy python-Levenshtein\n",
        "\n",
        "import pandas as pd\n",
        "import numpy as np\n",
        "from sklearn.feature_extraction.text import TfidfVectorizer\n",
        "from sklearn.cluster import KMeans, AgglomerativeClustering, DBSCAN\n",
        "from sklearn.decomposition import LatentDirichletAllocation\n",
        "from sklearn.metrics import silhouette_score\n",
        "import matplotlib.pyplot as plt\n",
        "import re\n",
        "from fuzzywuzzy import fuzz\n",
        "from fuzzywuzzy import process\n",
        "from difflib import SequenceMatcher"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "background_save": true
        },
        "id": "x_BM4zveW-nU"
      },
      "outputs": [],
      "source": [
        "# Load your data\n",
        "df = pd.read_csv('Faculty Entrada Queries.csv')\n",
        "\n",
        "# Load and remove whitespace\n",
        "df['Queries'] = df['Queries'].str.strip()\n",
        "\n",
        "# lowercasing result_sorted\n",
        "df['Queries'] = df['Queries'].str.lower()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "KjIVh7jXhV5a"
      },
      "outputs": [],
      "source": [
        "# manual mapping of similar terms that combine_similar won't pick up\n",
        "# 0.9, no mapping = 151 rows\n",
        "# 0.9 + mapping = 147 rows - good!\n",
        "\n",
        "manual_mapping = {\n",
        "    'trauma informed':'trauma informed practice',\n",
        "    'neonat': 'neonatology',\n",
        "    'attention deficit':'attention deficit hyperactivity disorder',\n",
        "    'trauma-inform':'trauma informed practice',\n",
        "    'nortth':'north'\n",
        "}\n",
        "\n",
        "df['Queries'] = df['Queries'].map(manual_mapping).fillna(df['Queries'])\n",
        "\n",
        "# adjustments from threshold = 0.8\n",
        "# bc guidelines 13 guidelines 5 -> bc guidelines 18\n",
        "# time management 7 management 10 -> time management 17\n",
        "# trauma informed 22 trauma informed practice 14\n",
        "# attention deficit hyperactivity disorder 16 attention deficit 3\n",
        "# neonat 6 neonatology 6\n",
        "\n",
        "#potential groups\n",
        "  #rural+cbl rural\n",
        "  #sexual + sexual abuse\n",
        "  #cbl hypothalamic + hypothalamic"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "Fr09ZbiKflPh",
        "outputId": "12ac4626-db61-4335-db50-d1bad45c97e0"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "                       Queries  Event count\n",
            "0    motivational interviewing           61\n",
            "1                    parkinson           60\n",
            "2     trauma informed practice           36\n",
            "3                *filters only           33\n",
            "4                 hypothalamic           29\n",
            "..                         ...          ...\n",
            "142                   calendar            3\n",
            "143              communication            3\n",
            "144                   abortion            3\n",
            "145                        wba            3\n",
            "146                 theme lead            3\n",
            "\n",
            "[147 rows x 2 columns]\n"
          ]
        }
      ],
      "source": [
        "#combines similar queries\n",
        "\n",
        "def similarity_ratio(a, b):\n",
        "    if pd.isna(a) or pd.isna(b):\n",
        "        return 0\n",
        "    return SequenceMatcher(None, str(a).lower(), str(b).lower()).ratio()\n",
        "    # takes 2 strings, finds same letters/characters, length of characters that are the same\n",
        "    # return similarity score (DOUBLE) based on sizes of similar chunks\n",
        "\n",
        "def combine_similar(df, query_col='Queries', count_col='Event count', threshold=0.9):\n",
        "  # 0.9 = 151 rows, no mapping\n",
        "    combined = {}\n",
        "    for i, row in df.iterrows():\n",
        "        if pd.isna(row[query_col]):\n",
        "            continue\n",
        "        matched = False\n",
        "        for key in combined:\n",
        "            if similarity_ratio(row[query_col], key) >= threshold:\n",
        "              #if similar, combine the two and make 1 row\n",
        "                combined[key] += row[count_col]\n",
        "                matched = True\n",
        "                break\n",
        "        if not matched:\n",
        "            #if not matched make separate\n",
        "            combined[row[query_col]] = row[count_col]\n",
        "    return pd.DataFrame({query_col: combined.keys(), count_col: combined.values()})\n",
        "    # go thru rows of queries and compares to each other\n",
        "\n",
        "# Load your CSV file\n",
        "\n",
        "result = combine_similar(df)\n",
        "result_sorted = result.sort_values('Event count', ascending=False).reset_index(drop=True)\n",
        "pd.set_option('display.max_rows', 10)\n",
        "\n",
        "\n",
        "# Display all rows\n",
        "print(result_sorted)\n"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "EbKmdy5OAknq",
        "outputId": "fa741125-e491-4657-fac7-04daf4f08ada"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "                                               Queries  Event count\n",
            "0                            motivational interviewing           61\n",
            "1                                            parkinson           60\n",
            "2                             trauma informed practice           36\n",
            "3                                        *filters only           33\n",
            "4                                         hypothalamic           29\n",
            "5                       faculty of medicine governance           24\n",
            "6                                     eating disorders           24\n",
            "7                                            toxidrome           21\n",
            "8             attention deficit hyperactivity disorder           19\n",
            "9                                adolescent depression           18\n",
            "10                                cultural sensitivity           18\n",
            "11                                     professionalism           17\n",
            "12                                       cholecystitis           15\n",
            "13                                   breast exam video           14\n",
            "14                  canadian resident matching service           14\n",
            "15                                           recording           13\n",
            "16                                          ophthalmol           13\n",
            "17                                                flex           13\n",
            "18                                       bc guidelines           13\n",
            "19                                  chronic pain panel           13\n",
            "20                                  respiratory system           13\n",
            "21                                             absence           12\n",
            "22                                         dermatology           12\n",
            "23                                         breast exam           12\n",
            "24                                physiology of ageing           12\n",
            "25                    policy on students and the media           12\n",
            "26                                         neonatology           12\n",
            "27                                          withdrawal           11\n",
            "28               development of the respiratory system           11\n",
            "29                                              policy           11\n",
            "30                    case based learning hypothalamic           11\n",
            "31                             child abuse and neglect           11\n",
            "32                                        chronic pain           11\n",
            "33                                     flex repository           11\n",
            "34                                        somatization           11\n",
            "35                            somatic symptom disorder           10\n",
            "36                                          management           10\n",
            "37                                           insurance           10\n",
            "38                                   exit competencies           10\n",
            "39                                             panopto           10\n",
            "40                                determinants of hope           10\n",
            "41                                         flex regist           10\n",
            "42                                      abdominal pain            9\n",
            "43                                              sexual            9\n",
            "44                                              gender            9\n",
            "45                                                iron            9\n",
            "46                                          attachment            9\n",
            "47                                          case brian            9\n",
            "48                                        sexual abuse            9\n",
            "49                                            violence            8\n",
            "50                                             scholar            8\n",
            "51                                       public health            8\n",
            "52                                    planetary health            8\n",
            "53                                  nutrition and exit            8\n",
            "54                                             fatigue            8\n",
            "55                                   caregiver burnout            8\n",
            "56                                               edema            8\n",
            "57                                          sexualized            7\n",
            "58                                     time management            7\n",
            "59                       social determinants of health            7\n",
            "60                                               aging            7\n",
            "61                                             refugee            7\n",
            "62                                                pgx2            7\n",
            "63                                      opioid driving            7\n",
            "64                                            lipidema            7\n",
            "65                                                hope            7\n",
            "66                                                 eye            7\n",
            "67                                      driving safety            7\n",
            "68   canadian resident matching service personal le...            7\n",
            "69                          assessment mechanism video            7\n",
            "70                                       antiepileptic            7\n",
            "71                                   scheduling policy            7\n",
            "72                                            practice            7\n",
            "73                                       refugee heath            6\n",
            "74                                        opioid renal            6\n",
            "75                portfolio assessment mechanism video            6\n",
            "76                             panopto account sign up            6\n",
            "77                                               video            6\n",
            "78                                       opioid kidney            6\n",
            "79                              androgen insensitivity            6\n",
            "80                          medd 421 lecture recording            6\n",
            "81                                                quiz            6\n",
            "82                        neonatal intensive care unit            6\n",
            "83                                            jaundice            6\n",
            "84                  occupational therapy nortth cohort            6\n",
            "85                                          indigenous            6\n",
            "86                                      neuroradiology            5\n",
            "87                                         courtmarche            5\n",
            "88                                        determinants            5\n",
            "89                                             driving            5\n",
            "90                                          geriatrics            5\n",
            "91                                          guidelines            5\n",
            "92                                    mood stabilizers            5\n",
            "93                                            must see            5\n",
            "94                                  policies and forms            5\n",
            "95                                              ocular            5\n",
            "96                                               ortho            5\n",
            "97                                        child health            5\n",
            "98                                           prolonged            5\n",
            "99                                          resilience            5\n",
            "100                                    student absence            5\n",
            "101                                     taser dementie            5\n",
            "102                                         transplant            5\n",
            "103                                      videsh kapoor            5\n",
            "104                                  year 2 assessment            5\n",
            "105                                       courtemanche            5\n",
            "106                                       fibromyalgia            5\n",
            "107                                            chatgpt            5\n",
            "108                                     intan schrader            5\n",
            "109                                          formulary            5\n",
            "110                                         up to date            5\n",
            "111                                   assessment video            5\n",
            "112           summative portfolio form assessment form            5\n",
            "113                                     absence policy            5\n",
            "114                                advisor meeting log            5\n",
            "115                          case based learning rural            5\n",
            "116                                     coach handbook            5\n",
            "117                          electroconvulsive therapy            5\n",
            "118                                           headache            5\n",
            "119                                              rural            5\n",
            "120                        interprofessional education            5\n",
            "121             quality improvement and patient safety            5\n",
            "122                                  medd 411 archived            5\n",
            "123                    transition to clinical learning            5\n",
            "124                                         smp awards            5\n",
            "125                                          addiction            5\n",
            "126                                               phrm            5\n",
            "127                               node package manager            5\n",
            "128                                             madden            5\n",
            "129                 medd 421 lecture recording doroudi            5\n",
            "130                                    access medicine            3\n",
            "131                                             social            3\n",
            "132                                          post call            3\n",
            "133                                          nutrition            3\n",
            "134                                 mental status exam            3\n",
            "135                                excitable membranes            3\n",
            "136                    case based learning obstructive            3\n",
            "137                              cardiac physical exam            3\n",
            "138                                               pain            3\n",
            "139                             perinatal pharmacology            3\n",
            "140                                            med 412            3\n",
            "141                  entrustable professional activity            3\n",
            "142                                           calendar            3\n",
            "143                                      communication            3\n",
            "144                                           abortion            3\n",
            "145                         workplace based assessment            3\n",
            "146                                         theme lead            3\n"
          ]
        }
      ],
      "source": [
        "#acronym dictionary, expands acronyms and applies them\n",
        "#acronym dictionary\n",
        "acronym_map = {\n",
        "    'adhd': 'attention deficit hyperactivity disorder',\n",
        "    'cbl': 'case based learning',\n",
        "    'ot': 'occupational therapy',\n",
        "    'carms': 'canadian resident matching service',\n",
        "    'nicu': 'neonatal intensive care unit',\n",
        "    'spf': 'summative portfolio form',\n",
        "    #'npm': 'northern medical program',\n",
        "    'qips': 'quality improvement and patient safety',\n",
        "    'wba': 'workplace based assessment',\n",
        "    'epa': 'entrustable professional activity'\n",
        "}\n",
        "\n",
        "# Function to expand acronyms\n",
        "def expand_acronyms(text):\n",
        "  #takes text, isolates it and replaces w longer version of word\n",
        "    words = text.split()\n",
        "    expanded_words = [acronym_map.get(word, word) for word in words]\n",
        "    return ' '.join(expanded_words)\n",
        "\n",
        "\n",
        "# Apply preprocessing\n",
        "result_sorted['Queries'] = result_sorted['Queries'].apply(expand_acronyms)\n",
        "\n",
        "pd.set_option('display.max_rows', None)\n",
        "\n",
        "print(result_sorted)"
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "df.sum()"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 146
        },
        "id": "FFFa79f0LHAA",
        "outputId": "caa935db-888c-4fa5-b646-8f24a2a9be10"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "Queries        parkinson*filters onlyhypothalamicmotivational...\n",
              "Event count                                                 1299\n",
              "dtype: object"
            ],
            "text/html": [
              "<div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>0</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>Queries</th>\n",
              "      <td>parkinson*filters onlyhypothalamicmotivational...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>Event count</th>\n",
              "      <td>1299</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "</div><br><label><b>dtype:</b> object</label>"
            ]
          },
          "metadata": {},
          "execution_count": 12
        }
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "kQhNV5he3mcS"
      },
      "source": [
        "##for future"
      ]
    },
    {
      "cell_type": "markdown",
      "source": [],
      "metadata": {
        "id": "PjwccmCLCJyb"
      }
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "ZpKHmoDSi1IV",
        "outputId": "c7bbb353-bdc1-4321-bd6c-19c229ebbe7e"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "                       Queries  Event count\n",
            "0    motivational interviewing           61\n",
            "1                    parkinson           60\n",
            "2                 hypothalamic           40\n",
            "3              trauma informed           36\n",
            "4                *Filters Only           33\n",
            "..                         ...          ...\n",
            "129                       pain            3\n",
            "130              communication            3\n",
            "131                   abortion            3\n",
            "132                        WBA            3\n",
            "133                 theme lead            3\n",
            "\n",
            "[134 rows x 2 columns]\n"
          ]
        }
      ],
      "source": [
        "def group_similar_queries(df, column_name, threshold=80):\n",
        "    # Get unique queries\n",
        "    unique_queries = df[column_name].unique()\n",
        "\n",
        "    # Dictionary to store grouped queries\n",
        "    grouped_queries = {}\n",
        "\n",
        "    for query in unique_queries:\n",
        "        if query not in grouped_queries:\n",
        "            # Find similar queries\n",
        "            matches = process.extract(query, unique_queries, limit=len(unique_queries), scorer=fuzz.ratio)\n",
        "\n",
        "            # Group queries that meet the similarity threshold\n",
        "            similar = [match[0] for match in matches if match[1] >= threshold]\n",
        "\n",
        "            # Use the most common query as the standardized form\n",
        "            standard = df[df[column_name].isin(similar)][column_name].mode().iloc[0]\n",
        "\n",
        "            # Add to grouped_queries dictionary\n",
        "            for sim in similar:\n",
        "                grouped_queries[sim] = standard\n",
        "\n",
        "    return grouped_queries\n",
        "\n",
        "# Apply the function to your DataFrame\n",
        "grouped = group_similar_queries(df, 'Queries')\n",
        "\n",
        "# Create a new column with standardized queries\n",
        "df['standardized_query'] = df['Queries'].map(grouped)\n",
        "\n",
        "#bc guidelines 13 guidelines 5 -> bc guidelines 18\n",
        "#time management 7 management 10 -> time management 17\n",
        "#trauma informed 22 trauma informed practice 14\n",
        "#attention deficit hyperactivity disorder 16 attention deficit 3\n",
        "#neonat 6 neonatology 6 neonatal intensive care unit 6\n",
        "\n",
        "\n",
        "# Display all rows\n",
        "print(result_sorted)"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "GNfwNH-Ma73m"
      },
      "source": [
        "# Iterations"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "xSyeWjHyAOvJ"
      },
      "source": [
        "## Entrada Queries: 1st iteration\n",
        "- [ ] Create a description of the project in the teams project folder. Create a word doc explaining what we are doing.\n",
        "- [ ] Get the search query data in this project.\n",
        "\n",
        "2024-10-15-09:45am.\n",
        "\n",
        "- [ ] Start working on themes"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "BobL3JulAoZj"
      },
      "outputs": [],
      "source": [
        "#combines similar queries\n",
        "\n",
        "pd.set_option('display.max_rows', None)\n",
        "\n",
        "def similarity_ratio(a, b):\n",
        "    if pd.isna(a) or pd.isna(b):\n",
        "        return 0\n",
        "    return SequenceMatcher(None, str(a).lower(), str(b).lower()).ratio()\n",
        "\n",
        "def combine_similar(df, query_col='Queries', count_col='Event count', threshold=0.8):\n",
        "    combined = {}\n",
        "    for i, row in df.iterrows():\n",
        "        if pd.isna(row[query_col]):\n",
        "            continue\n",
        "        matched = False\n",
        "        for key in combined:\n",
        "            if similarity_ratio(row[query_col], key) >= threshold:\n",
        "                combined[key] += row[count_col]\n",
        "                matched = True\n",
        "                break\n",
        "        if not matched:\n",
        "            combined[row[query_col]] = row[count_col]\n",
        "    return pd.DataFrame({query_col: combined.keys(), count_col: combined.values()})\n",
        "\n",
        "# Load your CSV file\n",
        "\n",
        "result = combine_similar(df)\n",
        "result_sorted = result.sort_values('Event count', ascending=False).reset_index(drop=True)\n",
        "\n",
        "# Display all rows\n",
        "#print(result_sorted)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 146
        },
        "id": "7gfHBXHCAscr",
        "outputId": "38b69bc8-3bd5-4015-c7ed-5f70c25412bc"
      },
      "outputs": [
        {
          "data": {
            "text/html": [
              "<div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>0</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>Queries</th>\n",
              "      <td>motivational interviewingparkinsonhypothalamic...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>Event count</th>\n",
              "      <td>1266</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "</div><br><label><b>dtype:</b> object</label>"
            ],
            "text/plain": [
              "Queries        motivational interviewingparkinsonhypothalamic...\n",
              "Event count                                                 1266\n",
              "dtype: object"
            ]
          },
          "execution_count": 11,
          "metadata": {},
          "output_type": "execute_result"
        }
      ],
      "source": [
        "result_sorted.sum()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "-Ck9VtfVAxOL"
      },
      "outputs": [],
      "source": [
        "#Organizing into Query types\n",
        "\n",
        "from sklearn.feature_extraction.text import TfidfVectorizer\n",
        "from sklearn.cluster import KMeans\n",
        "\n",
        "#takes queries and lists them by order\n",
        "queries = result_sorted['Queries'].tolist()\n",
        "\n",
        "#sets up the data to be organized\n",
        "vectorizer = TfidfVectorizer(stop_words='english')\n",
        "X = vectorizer.fit_transform(queries)\n",
        "\n",
        "#alterable\n",
        "num_clusters = 70\n",
        "\n",
        "#method of clustering data\n",
        "kmeans = KMeans(n_clusters=num_clusters, random_state=42)\n",
        "kmeans.fit(X)\n",
        "\n",
        "\n",
        "result_sorted['cluster'] = kmeans.labels_\n",
        "\n",
        "# Display queries in each cluster\n",
        "#for i in range(num_clusters):\n",
        " #   print(f\"Cluster {i}:\")\n",
        "  #  print(result_sorted[result_sorted['cluster'] == i]['Queries'].head().tolist())\n",
        "   # print(\"\\n\")"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "lRUDJC-8AzIc",
        "outputId": "58ccad9e-c724-4029-9529-f7639834f881"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Total number of queries: 142\n",
            "Number of queries assigned to clusters: 142\n"
          ]
        }
      ],
      "source": [
        "#check for all queries assigned to clusters\n",
        "print(f\"Total number of queries: {len(result_sorted)}\")\n",
        "print(f\"Number of queries assigned to clusters: {result_sorted['cluster'].count()}\")"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "49ZAbPB8A1lc",
        "outputId": "214742d0-b380-437c-ab9c-5663c01a32c6"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\n",
            "Cluster 0:\n",
            "- edema\n",
            "Total queries in Cluster 0: 1\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 1:\n",
            "- assessment mechanism video\n",
            "- video\n",
            "- assessment  video\n",
            "Total queries in Cluster 1: 3\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 2:\n",
            "- determinants\n",
            "Total queries in Cluster 2: 1\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 3:\n",
            "- sexual\n",
            "- sexual abuse\n",
            "Total queries in Cluster 3: 2\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 4:\n",
            "- driving safety\n",
            "Total queries in Cluster 4: 1\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 5:\n",
            "- absence\n",
            "- student absence\n",
            "- absence policy\n",
            "Total queries in Cluster 5: 3\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 6:\n",
            "- chronic pain panel\n",
            "- abdominal pain\n",
            "- pain\n",
            "Total queries in Cluster 6: 3\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 7:\n",
            "- trauma informed\n",
            "- trauma informed practice\n",
            "- practice\n",
            "Total queries in Cluster 7: 3\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 8:\n",
            "- excitable membranes\n",
            "Total queries in Cluster 8: 1\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 9:\n",
            "- nutrition and exit\n",
            "- nutrition\n",
            "Total queries in Cluster 9: 2\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 10:\n",
            "- policy on students and the media\n",
            "- policy\n",
            "- Scheduling policy\n",
            "Total queries in Cluster 10: 3\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 11:\n",
            "- flex\n",
            "- flex repository\n",
            "- flex regist\n",
            "Total queries in Cluster 11: 3\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 12:\n",
            "- child abuse and neglect\n",
            "Total queries in Cluster 12: 1\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 13:\n",
            "- planetary health\n",
            "Total queries in Cluster 13: 1\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 14:\n",
            "- MEDD 411 archived\n",
            "Total queries in Cluster 14: 1\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 15:\n",
            "- scholar\n",
            "Total queries in Cluster 15: 1\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 16:\n",
            "- rural\n",
            "- CBL rural\n",
            "Total queries in Cluster 16: 2\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 17:\n",
            "- hypothalamic\n",
            "Total queries in Cluster 17: 1\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 18:\n",
            "- respiratory system\n",
            "- Development of the respiratory system\n",
            "Total queries in Cluster 18: 2\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 19:\n",
            "- breast exam video\n",
            "- breast exam\n",
            "Total queries in Cluster 19: 2\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 20:\n",
            "- access medicine\n",
            "Total queries in Cluster 20: 1\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 21:\n",
            "- violence\n",
            "Total queries in Cluster 21: 1\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 22:\n",
            "- NPM\n",
            "Total queries in Cluster 22: 1\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 23:\n",
            "- refugee\n",
            "- refugee heath\n",
            "Total queries in Cluster 23: 2\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 24:\n",
            "- opioid renal\n",
            "Total queries in Cluster 24: 1\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 25:\n",
            "- neuroradiology\n",
            "Total queries in Cluster 25: 1\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 26:\n",
            "- recording\n",
            "Total queries in Cluster 26: 1\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 27:\n",
            "- determinants of hope\n",
            "- hope\n",
            "Total queries in Cluster 27: 2\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 28:\n",
            "- neonat\n",
            "Total queries in Cluster 28: 1\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 29:\n",
            "- panopto\n",
            "- panopto account sign up\n",
            "Total queries in Cluster 29: 2\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 30:\n",
            "- carms\n",
            "- carms personal letters\n",
            "Total queries in Cluster 30: 2\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 31:\n",
            "- ADHD\n",
            "Total queries in Cluster 31: 1\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 32:\n",
            "- geriatrics\n",
            "Total queries in Cluster 32: 1\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 33:\n",
            "- taser dementie\n",
            "Total queries in Cluster 33: 1\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 34:\n",
            "- Intan schrader\n",
            "Total queries in Cluster 34: 1\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 35:\n",
            "- motivational interviewing\n",
            "Total queries in Cluster 35: 1\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 36:\n",
            "- formulary\n",
            "Total queries in Cluster 36: 1\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 37:\n",
            "- social determinants of health\n",
            "- social\n",
            "Total queries in Cluster 37: 2\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 38:\n",
            "- gender\n",
            "Total queries in Cluster 38: 1\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 39:\n",
            "- resilience\n",
            "Total queries in Cluster 39: 1\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 40:\n",
            "- Iron\n",
            "Total queries in Cluster 40: 1\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 41:\n",
            "- communication\n",
            "Total queries in Cluster 41: 1\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 42:\n",
            "- abortion\n",
            "Total queries in Cluster 42: 1\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 43:\n",
            "- caregiver burnout\n",
            "Total queries in Cluster 43: 1\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 44:\n",
            "- professionalism\n",
            "Total queries in Cluster 44: 1\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 45:\n",
            "- HEADACHE\n",
            "Total queries in Cluster 45: 1\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 46:\n",
            "- Interprofessional  education\n",
            "Total queries in Cluster 46: 1\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 47:\n",
            "- policies and forms\n",
            "Total queries in Cluster 47: 1\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 48:\n",
            "- adolescent depression\n",
            "Total queries in Cluster 48: 1\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 49:\n",
            "- fibromyalgia\n",
            "Total queries in Cluster 49: 1\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 50:\n",
            "- nicu\n",
            "Total queries in Cluster 50: 1\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 51:\n",
            "- neonatology\n",
            "Total queries in Cluster 51: 1\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 52:\n",
            "- case brian\n",
            "Total queries in Cluster 52: 1\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 53:\n",
            "- Calendar\n",
            "Total queries in Cluster 53: 1\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 54:\n",
            "- courtemanche\n",
            "Total queries in Cluster 54: 1\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 55:\n",
            "- advisor meeting log\n",
            "Total queries in Cluster 55: 1\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 56:\n",
            "- Coach Handbook\n",
            "Total queries in Cluster 56: 1\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 57:\n",
            "- chatgpt\n",
            "Total queries in Cluster 57: 1\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 58:\n",
            "- antiepileptic\n",
            "Total queries in Cluster 58: 1\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 59:\n",
            "- prolonged\n",
            "Total queries in Cluster 59: 1\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 60:\n",
            "- ortho\n",
            "Total queries in Cluster 60: 1\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 61:\n",
            "- eating disorders\n",
            "- faculty of medicine governance\n",
            "- toxidrome\n",
            "- cultural sensitivity\n",
            "- bc guidelines\n",
            "- time management\n",
            "- cholecystitis\n",
            "- ophthalmol\n",
            "- dermatology\n",
            "- Physiology of Ageing\n",
            "- somatization\n",
            "- MEDD 421 lecture recording\n",
            "- withdrawal\n",
            "- insurance\n",
            "- somatic symptom disorder\n",
            "- fatigue\n",
            "- public health\n",
            "- sexualized\n",
            "- Aging\n",
            "- eye\n",
            "- lipidema\n",
            "- PGX2\n",
            "- jaundice\n",
            "- indigenous\n",
            "- androgen insensitivity\n",
            "- OT nortth cohort\n",
            "- opioid kidney\n",
            "- ocular\n",
            "- mood stabilizers\n",
            "- must see\n",
            "- videsh kapoor\n",
            "- year 2 assessment\n",
            "- child health\n",
            "- addiction\n",
            "- SPF assessment Form\n",
            "- Electroconvulsive Therapy\n",
            "- up to date\n",
            "- SMP awards\n",
            "- QIPS\n",
            "- Transition to Clinical Learning\n",
            "- Madden\n",
            "- post call\n",
            "- mental status exam\n",
            "- CBL obstructive\n",
            "- Attention deficit\n",
            "- Perinatal Pharmacology\n",
            "- Med 412\n",
            "- EPA\n",
            "- WBA\n",
            "- theme lead\n",
            "Total queries in Cluster 61: 50\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 62:\n",
            "- cardiac physical exam\n",
            "Total queries in Cluster 62: 1\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 63:\n",
            "- transplant\n",
            "Total queries in Cluster 63: 1\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 64:\n",
            "- exit competencies\n",
            "Total queries in Cluster 64: 1\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 65:\n",
            "- PHRM\n",
            "Total queries in Cluster 65: 1\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 66:\n",
            "- attachment\n",
            "Total queries in Cluster 66: 1\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 67:\n",
            "- opioid driving\n",
            "- driving\n",
            "Total queries in Cluster 67: 2\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 68:\n",
            "- parkinson\n",
            "Total queries in Cluster 68: 1\n",
            "--------------------------------------------------\n",
            "\n",
            "Cluster 69:\n",
            "- quiz\n",
            "Total queries in Cluster 69: 1\n",
            "--------------------------------------------------\n"
          ]
        }
      ],
      "source": [
        "for cluster in sorted(result_sorted['cluster'].unique()):\n",
        "    print(f\"\\nCluster {cluster}:\")\n",
        "    cluster_queries = result_sorted[result_sorted['cluster'] == cluster]['Queries'].tolist()\n",
        "    for query in cluster_queries:\n",
        "        print(f\"- {query}\")\n",
        "    print(f\"Total queries in Cluster {cluster}: {len(cluster_queries)}\")\n",
        "    print(\"-\" * 50)  # Separator line\n",
        "\n",
        "# Summary statistics\n",
        "#print(\"\\nSummary:\")\n",
        "#print(result_sorted['cluster'].value_counts().sort_index())\n",
        "#print(f\"\\nTotal number of queries: {len(result_sorted)}\")\n",
        "#print(f\"Number of clusters: {result_sorted['cluster'].nunique()}\")"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "E4nyEPG_DJSU"
      },
      "outputs": [],
      "source": [
        "from google.colab import drive\n",
        "drive.mount('/content/drive')"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "BVz7QJSjA2hu"
      },
      "source": [
        "## Iteration 2"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "QWrMvSxPaoH3"
      },
      "outputs": [],
      "source": [
        "#combines similar queries\n",
        "\n",
        "pd.set_option('display.max_rows', None)\n",
        "\n",
        "def similarity_ratio(a, b):\n",
        "    if pd.isna(a) or pd.isna(b):\n",
        "        return 0\n",
        "    return SequenceMatcher(None, str(a).lower(), str(b).lower()).ratio()\n",
        "\n",
        "def combine_similar(df, query_col='Queries', count_col='Event count', threshold=0.8):\n",
        "    combined = {}\n",
        "    for i, row in df.iterrows():\n",
        "        if pd.isna(row[query_col]):\n",
        "            continue\n",
        "        matched = False\n",
        "        for key in combined:\n",
        "            if similarity_ratio(row[query_col], key) >= threshold:\n",
        "                combined[key] += row[count_col]\n",
        "                matched = True\n",
        "                break\n",
        "        if not matched:\n",
        "            combined[row[query_col]] = row[count_col]\n",
        "    return pd.DataFrame({query_col: combined.keys(), count_col: combined.values()})\n",
        "\n",
        "# Load your CSV file\n",
        "\n",
        "result = combine_similar(df)\n",
        "result_sorted = result.sort_values('Event count', ascending=False).reset_index(drop=True)\n",
        "\n",
        "# Display all rows\n",
        "#print(result_sorted)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 1000
        },
        "id": "rvV82MXoA5CK",
        "outputId": "b644e493-9d34-42d2-8084-53d0e25ca214"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Kmeans Silhouette Score: 0.28306129040606065\n",
            "Kmeans Cluster Distribution:\n",
            "kmeans_cluster\n",
            "1    168\n",
            "4      6\n",
            "0      6\n",
            "2      2\n",
            "3      2\n",
            "Name: count, dtype: int64\n",
            "\n",
            "\n",
            "Hierarchical Silhouette Score: 0.31180829373392177\n",
            "Hierarchical Cluster Distribution:\n",
            "hierarchical_cluster\n",
            "0    160\n",
            "1      8\n",
            "4      6\n",
            "2      6\n",
            "3      4\n",
            "Name: count, dtype: int64\n",
            "\n",
            "\n",
            "Dbscan Silhouette Score: 0.24651827818506789\n",
            "Dbscan Cluster Distribution:\n",
            "dbscan_cluster\n",
            "-1    108\n",
            " 0     71\n",
            " 1      5\n",
            "Name: count, dtype: int64\n",
            "\n",
            "\n",
            "Lda Silhouette Score: 0.24191041109911854\n",
            "Lda Cluster Distribution:\n",
            "lda_cluster\n",
            "0    89\n",
            "1    29\n",
            "2    26\n",
            "3    24\n",
            "4    16\n",
            "Name: count, dtype: int64\n",
            "\n",
            "\n"
          ]
        },
        {
          "data": {
            "image/png": "iVBORw0KGgoAAAANSUhEUgAAA1IAAAIeCAYAAACxyz6kAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjcuMSwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/bCgiHAAAACXBIWXMAAA9hAAAPYQGoP6dpAABS3ElEQVR4nO3deVhU5f//8dcgi4osogKiqOSS+15q+smNwiWyok/pV3NNKzXXFqmPmmahlkuaSqu2aFbmbq5omqXmmi2u5VYGlAYIJqLcvz+6mF8joBwDZ8Dn47rOpXOf+5zznuEMF6+559zHZowxAgAAAADkmZuzCwAAAACAwoYgBQAAAAAWEaQAAAAAwCKCFAAAAABYRJACAAAAAIsIUgAAAABgEUEKAAAAACwiSAEAAACARQQpAAAAALCIIAXAkhdeeEE2m+2GHKtNmzZq06aN/fEXX3whm82mRYsW3ZDj9+7dW1WqVLkhx7peqampevTRRxUcHCybzaZhw4Y5u6TrlvXz/eKLL5xdCmDZ8ePHZbPZNG/ePGeXAuAGIUgBN7F58+bJZrPZl+LFiyskJEQRERGaMWOGzp07ly/HOX36tF544QXt27cvX/aXn1y5trx4+eWXNW/ePD3xxBP64IMP9Mgjj1y1f0ZGhmbMmKHbbrtNPj4+KlWqlG677TbNnDlTly5dukFVu6bZs2fLZrOpWbNmzi6lwLRp00Z169bN1h4XF6eSJUuqcePGOnv2rBMqc21ffPGFHnjgAQUHB8vT01OBgYGKjIzU4sWLb1gNP/74o1544QUdP378hh0TwNW5O7sAAM43fvx4hYWFKSMjQ/Hx8friiy80bNgwTZ06VcuXL1f9+vXtff/3v/9p1KhRlvZ/+vRpjRs3TlWqVFHDhg3zvN26dessHed6XK22t956S5mZmQVew7+xceNGNW/eXGPHjr1m37S0NHXu3FmbN2/WPffco969e8vNzU1r1qzRkCFDtHTpUq1YsUIlS5a8AZVnd+edd+qvv/6Sp6enU44/f/58ValSRd98842OHj2qatWqOaWOG23jxo2KjIzUrbfeqg0bNiggIMDZJbmUsWPHavz48apevboee+wxVa5cWWfOnNHnn3+uqKgozZ8/X//3f/9X4HX8+OOPGjdunNq0aePyI+XAzYIgBUAdO3ZU06ZN7Y+jo6O1ceNG3XPPPbr33nt14MABlShRQpLk7u4ud/eC/dVx/vx5lSxZ0ml/UGfx8PBw6vHzIjExUbVr185T3xEjRmjz5s2aOXOmBg8ebG9/4oknNGvWLA0ePFhPP/20Zs2aVVDl5ujChQvy9PSUm5ubihcvfkOPneXYsWP6+uuvtXjxYj322GOaP39+nsJpXvzz+bmazZs3KzIyUjVq1CBE5WDRokUaP368HnzwQS1YsMDhd8LTTz+ttWvXKiMjw4kV/ntpaWny9vZ2dhlA4WQA3LTmzp1rJJmdO3fmuP7ll182ksybb75pbxs7dqy58lfHunXrTMuWLY2fn5/x9vY2NWrUMNHR0cYYYzZt2mQkZVvmzp1rjDGmdevWpk6dOmbXrl3mP//5jylRooQZOnSofV3r1q3tx8na18KFC010dLQJCgoyJUuWNJGRkebkyZMONVWuXNn06tUr23P65z6vVVuvXr1M5cqVHbZPTU01I0aMMBUrVjSenp6mRo0a5pVXXjGZmZkO/SSZQYMGmSVLlpg6deoYT09PU7t2bbN69eocX+srJSQkmL59+5rAwEDj5eVl6tevb+bNm5fttbhyOXbsWI77O3XqlClWrJhp165drsds27atcXd3N7/88osxxphjx445vB5XPr+xY8c6tP3yyy+mT58+JjAw0P5833nnHYc+WXV/9NFH5vnnnzchISHGZrOZP//8075u06ZNDtts377dREREGF9fX1OiRAlz5513mq1btzr0SUlJMUOHDjWVK1c2np6eply5ciY8PNzs3r071+f7Ty+++KIpXbq0SU9PN0888YSpXr16jv3+/PNPM2zYMPtxKlSoYB555BHz+++/X/P5GWPMJ598Yho3bmyKFy9uypQpY7p3725/vbP89ttvpnfv3qZChQrG09PTBAcHm3vvvdfhZ7tz505z9913mzJlypjixYubKlWqmD59+lzzeWa934wxZsuWLcbb29vUr1/fXv/VVK5c2XTu3Nls2rTJNGnSxBQvXtzUrVvX/vP67LPPTN26dY2Xl5dp3Lix2bNnT7Z9HDhwwERFRZnSpUsbLy8v06RJE7Ns2TKHPmfOnDEjR440devWNd7e3sbHx8d06NDB7Nu3z6Ff1mv98ccfmwkTJpgKFSoYLy8v065dO3PkyBGHvocPHzYPPPCACQoKMl5eXqZChQrm4YcfNklJSVd9zjVr1jQBAQEmJSXlmq9PTu+XK3+HZcnpd8tHH31kGjdubEqVKmV8fHxM3bp1zfTp040x//939ZXLP98rn3/+uWnVqpUpWbKkKVWqlOnUqZP5/vvvsx3X29vbHD161HTs2NGUKlXKdOnS5V+9RsDNjBEpALl65JFH9Nxzz2ndunXq379/jn1++OEH3XPPPapfv77Gjx8vLy8vHT16VF999ZUkqVatWho/frzGjBmjAQMG6D//+Y8k6Y477rDv48yZM+rYsaO6du2qHj16KCgo6Kp1vfTSS7LZbHr22WeVmJio6dOnKzw8XPv27bOPnOVFXmr7J2OM7r33Xm3atEn9+vVTw4YNtXbtWj399NP69ddfNW3aNIf+W7du1eLFizVw4ED5+PhoxowZioqK0smTJ1WmTJlc6/rrr7/Upk0bHT16VIMHD1ZYWJg+/fRT9e7dW0lJSRo6dKhq1aqlDz74QMOHD1fFihU1cuRISVK5cuVy3Ofq1at1+fJl9ezZM9fj9uzZU5s2bdKaNWvUr1+/q752V0pISFDz5s1ls9k0ePBglStXTqtXr1a/fv2UkpKSbRKMF198UZ6ennrqqaeUnp6e6+jjxo0b1bFjRzVp0kRjx46Vm5ub5s6dq3bt2unLL7/U7bffLkl6/PHHtWjRIg0ePFi1a9fWmTNntHXrVh04cECNGze+Zv3z58/XAw88IE9PT3Xr1k1z5szRzp07ddttt9n7pKam6j//+Y8OHDigvn37qnHjxvrjjz+0fPly/fLLLypbtuxVn9+8efPUp08f3XbbbYqJiVFCQoJee+01ffXVV9q7d6/8/f0lSVFRUfrhhx/05JNPqkqVKkpMTNT69et18uRJ++O7775b5cqV06hRo+Tv76/jx49bul7nq6++UqdOnRQWFqa4uDiH2q/m6NGj+r//+z899thj6tGjh1599VVFRkYqNjZWzz33nAYOHChJiomJ0UMPPaRDhw7ZR+J++OEHtWzZUhUqVNCoUaPk7e2tTz75RPfdd58+++wz3X///ZKkn3/+WUuXLtV///tfhYWFKSEhQW+88YZat26tH3/8USEhIQ41TZw4UW5ubnrqqaeUnJysyZMnq3v37tqxY4ck6eLFi4qIiFB6erqefPJJBQcH69dff9XKlSuVlJQkPz+/HJ/rkSNHdPDgQfXt21c+Pj55fm2vx/r169WtWze1b99ekyZNkiQdOHBAX331lYYOHao777xTQ4YM0YwZM/Tcc8+pVq1akmT/94MPPlCvXr0UERGhSZMm6fz585ozZ45atWqlvXv3OnwV8NKlS4qIiFCrVq306quvqmTJktf9GgE3PWcnOQDOc60RKWOM8fPzM40aNbI/vnJEatq0aUbSVT/R3rlzZ64jG61btzaSTGxsbI7rchqRqlChgsMnxJ988omRZF577TV7W15GpK5V25WfGi9dutRIMhMmTHDo9+CDDxqbzWaOHj1qb5NkPD09Hdq+/fZbI8nMnDkz27H+afr06UaS+fDDD+1tFy9eNC1atDClSpVyeO5ZowTXMmzYMCPJ7N27N9c+e/bsMZLMiBEjjDHWRqT69etnypcvb/744w+Hfl27djV+fn7m/Pnzxpj//zO85ZZb7G1ZrhyRyszMNNWrVzcREREOI37nz583YWFh5q677rK3+fn5mUGDBl3zdcjJrl27jCSzfv16+3ErVqxoHxnNMmbMGCPJLF68ONs+surL7fldvHjRBAYGmrp165q//vrL3r5y5UojyYwZM8YY8/eIlyTzyiuv5FrvkiVLrvm+zU3r1q1NQECA8fHxMXXq1DGJiYl53rZy5cpGkvn666/tbWvXrjWSTIkSJcyJEyfs7W+88Ua2EZP27dubevXqmQsXLtjbMjMzzR133OEwAnjhwgVz+fJlh2MfO3bMeHl5mfHjx9vbsl7rWrVqmfT0dHv7a6+9ZiSZ7777zhhjzN69e40k8+mnn+b5uRpjzLJly4wkM23atDz1/zcjUkOHDjW+vr7m0qVLue7/008/zXHE9ty5c8bf39/079/foT0+Pt74+fk5tPfq1ctIMqNGjXLoe72vEXCzc70vbANwKaVKlbrq7H1Zn6IvW7bsuidm8PLyUp8+ffLcv2fPng6fED/44IMqX768Pv/88+s6fl59/vnnKlasmIYMGeLQPnLkSBljtHr1aof28PBwVa1a1f64fv368vX11c8//3zN4wQHB6tbt272Ng8PDw0ZMkSpqanavHmz5dqzfoZX+2Q9a53V2RqNMfrss88UGRkpY4z++OMP+xIREaHk5GTt2bPHYZtevXpdc/Rw3759OnLkiP7v//5PZ86cse8zLS1N7du315YtW+znnL+/v3bs2KHTp09bql36ezQqKChIbdu2lSTZbDY9/PDDWrhwoS5fvmzv99lnn6lBgwb2kZN/uvKWAFc+v127dikxMVEDBw50uA6sc+fOqlmzplatWiVJKlGihDw9PfXFF1/ozz//zLHerPfcypUrr+v6nLS0NJ07d05BQUHy9fW1tG3t2rXVokUL++OsGQ7btWunSpUqZWvPOtfPnj2rjRs36qGHHtK5c+fsP8szZ84oIiJCR44c0a+//irp798HWaNYly9f1pkzZ1SqVCndeuut2c4jSerTp4/DiGbWyHLWsbNGU9auXavz58/n+bmmpKRIuvp7Jr/4+/srLS1N69evt7zt+vXrlZSUpG7dujm894oVK6ZmzZpp06ZN2bZ54oknHB5f72sE3OwIUgCuKjU19ap/SDz88MNq2bKlHn30UQUFBalr16765JNPLIWqChUqWJpYonr16g6PbTabqlWrVuDTAp84cUIhISHZXo+sr9ecOHHCof2ff1hmKV26dK5/IP/zONWrV882OUFux8mLvISkrHWBgYGW9v37778rKSlJb775psqVK+ewZAXkxMREh23CwsKuud8jR45I+juUXLnft99+W+np6UpOTpYkTZ48Wd9//71CQ0N1++2364UXXrhmYJX+/kN94cKFatu2rY4dO6ajR4/q6NGjatasmRISEhQXF2fv+9NPP+U4dXhOrnx+WT+zW2+9NVvfmjVr2td7eXlp0qRJWr16tYKCgnTnnXdq8uTJio+Pt/dv3bq1oqKiNG7cOJUtW1ZdunTR3LlzlZ6enqfaqlWrpkmTJmnjxo3q1q2bQ1hMTU1VfHy8ffn9998dtr3ynM76Azw0NDTH9qxz/ejRozLGaPTo0dl+llmTemSdI5mZmZo2bZqqV68uLy8vlS1bVuXKldP+/fvtP++r1VS6dGmHY4eFhWnEiBF6++23VbZsWUVERGjWrFk57uufskJmft0G4moGDhyoGjVqqGPHjqpYsaL69u2rNWvW5GnbrPdJu3btsr2269aty/bec3d3V8WKFR3arvc1Am52XCMFIFe//PKLkpOTrzoNdIkSJbRlyxZt2rRJq1at0po1a/Txxx+rXbt2WrdunYoVK3bN41i5rimvcrtp8OXLl/NUU37I7TjGmBty/H/Kmtlv//79uU5Bv3//fknSLbfcIunqr+E/ZYXmHj16qFevXjlu888p9KW8/cyz9vvKK6/kWnOpUqUkSQ899JD+85//aMmS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zNqHa3rqqac0YMAADR06VMuXL9eOHTu0Y8cOLV++XEOHDtXjjz+uZ555xtlloogoX768Fi9erMzMzByXPXv2OLtEFAF//fWX3N3//3xLNptNc+bMUWRkpFq3bq3Dhw87sToUNVlfi3dzc1Px4sXl5+dnX+fj46Pk5GRnlYYi5rbbbtPu3bv1+++/q2nTpvr++++zXZaB/MOsfbimQYMGqWzZspo2bZpmz55t/4S2WLFiatKkiebNm6eHHnrIyVWiqGjSpIl2796tLl265Lj+WqNVQF7UrFlTu3btyjaL1euvvy5Juvfee51RFoqgKlWq6MiRI6pataokadu2bapUqZJ9/cmTJ+3X5gH5oVSpUnrvvfe0cOFChYeHM7JegPhqHyzJyMjQH3/8IUkqW7asPDw8nFwRipovv/xSaWlp6tChQ47r09LStGvXLrVu3foGV4aiJCYmRl9++aU+//zzHNcPHDhQsbGxyszMvMGVoaiJjY1VaGioOnfunOP65557TomJiXr77bdvcGW4Gfzyyy/avXu3wsPD5e3t7exyihyCFAAAAABYxDVSAAAAAGARQQoAAAAALCJIAQAAAIBFBCkAQJFjs9m0dOlSZ5cBACjCCFIAgEInPj5eTz75pG655RZ5eXkpNDRUkZGRiouLy/djffHFF7LZbEpKSsr3fQMACi/uIwUAKFSOHz+uli1byt/fX6+88orq1aunjIwMrV27VoMGDdLBgwedXWKOjDG6fPmyw42AAQCFFyNSAIBCZeDAgbLZbPrmm28UFRWlGjVqqE6dOhoxYoS2b9+erX9OI0r79u2TzWbT8ePHJUknTpxQZGSkSpcuLW9vb9WpU0eff/65jh8/rrZt20qSSpcuLZvNpt69e0uSMjMzFRMTo7CwMJUoUUINGjTQokWLsh139erVatKkiby8vLR169YCe10AADcWH4sBAAqNs2fPas2aNXrppZdyvLmkv7//de130KBBunjxorZs2SJvb2/9+OOPKlWqlEJDQ/XZZ58pKipKhw4dkq+vr0qUKCHp75v6fvjhh4qNjVX16tW1ZcsW9ejRQ+XKlXO4YfSoUaP06quv6pZbblHp0qWvqz4AgOshSAEACo2jR4/KGKOaNWvm635PnjypqKgo1atXT5J0yy232NcFBARIkgIDA+1BLT09XS+//LI2bNigFi1a2LfZunWr3njjDYcgNX78eN111135Wi8AwPkIUgCAQsMYUyD7HTJkiJ544gmtW7dO4eHhioqKUv369XPtf/ToUZ0/fz5bQLp48aIaNWrk0Na0adMCqRkA4FwEKQBAoVG9enXZbDZLE0q4uf19OfA/Q1hGRoZDn0cffVQRERFatWqV1q1bp5iYGE2ZMkVPPvlkjvtMTU2VJK1atUoVKlRwWOfl5eXwOKevIAIACj8mmwAAFBoBAQGKiIjQrFmzlJaWlm19TlOUlytXTpL022+/2dv27duXrV9oaKgef/xxLV68WCNHjtRbb70lSfL09JQkXb582d63du3a8vLy0smTJ1WtWjWHJTQ09N88RQBAIUGQAgAUKrNmzdLly5d1++2367PPPtORI0d04MABzZgxw3690j9lhZsXXnhBR44c0apVqzRlyhSHPsOGDdPatWt17Ngx7dmzR5s2bVKtWrUkSZUrV5bNZtPKlSv1+++/KzU1VT4+Pnrqqac0fPhwvffee/rpp5+0Z88ezZw5U++9994NeR0AAM5FkAIAFCq33HKL9uzZo7Zt22rkyJGqW7eu7rrrLsXFxWnOnDnZ+nt4eOijjz7SwYMHVb9+fU2aNEkTJkxw6HP58mUNGjRItWrVUocOHVSjRg3Nnj1bklShQgWNGzdOo0aNUlBQkAYPHixJevHFFzV69GjFxMTYt1u1apXCwsIK/kUAADidzRTUlbsAAAAAUEQxIgUAAAAAFhGkAAAAAMAighQAAAAAWESQAgAAAACLCFIAAAAAYBFBCgAAAAAsIkgBAAAAgEUEKQAAAACwiCAFAAAAABYRpAAAAADAIoIUAAAAAFhEkAIAAAAAi/4fUcHlccXDzIIAAAAASUVORK5CYII=\n",
            "text/plain": [
              "<Figure size 1000x600 with 1 Axes>"
            ]
          },
          "metadata": {},
          "output_type": "display_data"
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Top terms per K-means cluster:\n",
            "Cluster 0: health, social, determinants, child, withdrawal, hope, guidelines, governance, flex, fatigue\n",
            "Cluster 1: policy, exam, carms, assessment, video, pain, respiratory, flex, management, withdrawal\n",
            "Cluster 2: guidelines, withdrawal, determinants, hope, health, governance, flex, fatigue, faculty, exit\n",
            "Cluster 3: toxidrome, withdrawal, determinants, hope, health, guidelines, governance, flex, fatigue, faculty\n",
            "Cluster 4: motivational, interviewing, withdrawal, hypothalamic, health, guidelines, governance, flex, fatigue, faculty\n",
            "\n",
            "Top terms per LDA topic:\n",
            "Cluster 0: health, insurance, guidelines, toxidromes, adhd, refugee, rural, physiology, aging, sexual\n",
            "Cluster 1: motivational, interviewing, pain, respiratory, management, flex, recording, panopto, cholecystitis, medd\n",
            "Cluster 2: exam, carms, trauma, breast, driving, opioid, practice, medicine, informed, hypothalamic\n",
            "Cluster 3: policy, withdrawal, determinants, disorders, eating, fatigue, toxidrome, professionalism, sensitivity, cultural\n",
            "Cluster 4: assessment, video, absence, dermatology, child, mechanism, exit, social, hope, abuse\n"
          ]
        }
      ],
      "source": [
        "# Vectorize the text data\n",
        "vectorizer = TfidfVectorizer(stop_words='english', min_df=2, max_df=0.95)\n",
        "X = vectorizer.fit_transform(df['Queries'])\n",
        "\n",
        "# Function to evaluate clustering\n",
        "def evaluate_clustering(labels, X):\n",
        "    if len(set(labels)) > 1:  # Silhouette score requires at least 2 clusters\n",
        "        return silhouette_score(X, labels)\n",
        "    else:\n",
        "        return np.nan\n",
        "\n",
        "# 1. K-means\n",
        "n_clusters = 5  # Adjust as needed\n",
        "kmeans = KMeans(n_clusters=n_clusters, random_state=42)\n",
        "df['kmeans_cluster'] = kmeans.fit_predict(X)\n",
        "\n",
        "# 2. Hierarchical Clustering\n",
        "hierarchical = AgglomerativeClustering(n_clusters=n_clusters)\n",
        "df['hierarchical_cluster'] = hierarchical.fit_predict(X.toarray())\n",
        "\n",
        "# 3. DBSCAN\n",
        "dbscan = DBSCAN(eps=0.5, min_samples=5)  # Adjust parameters as needed\n",
        "df['dbscan_cluster'] = dbscan.fit_predict(X)\n",
        "\n",
        "# 4. Latent Dirichlet Allocation (LDA)\n",
        "lda = LatentDirichletAllocation(n_components=n_clusters, random_state=42)\n",
        "lda_output = lda.fit_transform(X)\n",
        "df['lda_cluster'] = lda_output.argmax(axis=1)\n",
        "\n",
        "# Evaluate and compare results\n",
        "methods = ['kmeans', 'hierarchical', 'dbscan', 'lda']\n",
        "for method in methods:\n",
        "    score = evaluate_clustering(df[f'{method}_cluster'], X)\n",
        "    print(f\"{method.capitalize()} Silhouette Score: {score}\")\n",
        "    print(f\"{method.capitalize()} Cluster Distribution:\")\n",
        "    print(df[f'{method}_cluster'].value_counts())\n",
        "    print(\"\\n\")\n",
        "\n",
        "# Visualize results (example for K-means)\n",
        "plt.figure(figsize=(10, 6))\n",
        "df['kmeans_cluster'].value_counts().sort_index().plot(kind='bar')\n",
        "plt.title('Distribution of Queries Across K-means Clusters')\n",
        "plt.xlabel('Cluster')\n",
        "plt.ylabel('Number of Queries')\n",
        "plt.show()\n",
        "\n",
        "# Function to display top terms for each cluster\n",
        "def print_top_terms(cluster_centers, feature_names, top_n=10):\n",
        "    for i, center in enumerate(cluster_centers):\n",
        "        top_indices = center.argsort()[-top_n:][::-1]\n",
        "        top_terms = [feature_names[j] for j in top_indices]\n",
        "        print(f\"Cluster {i}: {', '.join(top_terms)}\")\n",
        "\n",
        "# Display top terms for K-means clusters\n",
        "print(\"Top terms per K-means cluster:\")\n",
        "print_top_terms(kmeans.cluster_centers_, vectorizer.get_feature_names_out())\n",
        "\n",
        "# Display top terms for LDA topics\n",
        "print(\"\\nTop terms per LDA topic:\")\n",
        "print_top_terms(lda.components_, vectorizer.get_feature_names_out())"
      ]
    }
  ],
  "metadata": {
    "colab": {
      "collapsed_sections": [
        "BVz7QJSjA2hu"
      ],
      "provenance": [],
      "include_colab_link": true
    },
    "kernelspec": {
      "display_name": "Python 3",
      "name": "python3"
    },
    "language_info": {
      "name": "python"
    }
  },
  "nbformat": 4,
  "nbformat_minor": 0
}
